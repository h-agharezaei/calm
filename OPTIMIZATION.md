# بهینه‌سازی عملکرد / Performance Optimization

## مشکل / Problem
حجم بالای تصاویر باعث کند شدن بارگذاری سایت می‌شد.

## راهکارهای پیاده‌سازی شده / Implemented Solutions

### 1. Loading Overlay (صفحه بارگذاری)
- نمایش یک spinner انیمیشن‌دار هنگام بارگذاری
- پیام "در حال بارگذاری..." برای کاربر
- مخفی شدن خودکار پس از بارگذاری تصویر اولیه

**فایل‌های تغییر یافته:**
- `index.html`: اضافه شدن div با id="loadingOverlay"
- `assets/css/style.css`: استایل‌های loading overlay و spinner animation

### 2. Progressive Image Loading (بارگذاری تدریجی تصاویر)
- **بارگذاری هوشمند تصویر اولیه**: فقط تصویر فعلی در ابتدا لود می‌شود
- **Preloading در پس‌زمینه**: سایر تصاویر به تدریج و با تاخیر لود می‌شوند
- **جلوگیری از بارگذاری مجدد**: تصاویر لود شده در Set ذخیره می‌شوند

**توابع جدید در `script.js`:**
```javascript
- preloadImage(imageName): Promise برای بارگذاری یک تصویر
- preloadAllImages(): بارگذاری تمام تصاویر در پس‌زمینه با فاصله
- initializeApp(): مقداردهی اولیه و بارگذاری تصویر اول
- hideLoadingOverlay(): مخفی کردن loading screen
```

### 3. Lazy Loading for Thumbnails (بارگذاری تنبل برای thumbnails)
- Thumbnails فقط زمانی لود می‌شوند که پنل تنظیمات باز شود
- استفاده از attribute `data-src` به جای `src`
- بارگذاری با تاخیر برای بهینه‌سازی بیشتر

**تغییرات:**
- `index.html`: تغییر `src` به `data-src` و اضافه کردن class="lazy-thumbnail"
- `script.js`: تابع `lazyLoadThumbnails()` برای بارگذاری هنگام باز شدن پنل

## نتایج / Results

### قبل از بهینه‌سازی:
- ❌ بارگذاری همزمان تمام تصاویر (5 عکس با حجم بالا)
- ❌ بارگذاری همزمان تمام thumbnails
- ❌ عدم بازخورد به کاربر در حین بارگذاری
- ❌ تجربه کاربری ضعیف با صفحه خالی

### بعد از بهینه‌سازی:
- ✅ بارگذاری فقط یک تصویر در ابتدا
- ✅ Thumbnails فقط در صورت نیاز لود می‌شوند
- ✅ نمایش loading spinner برای بازخورد بصری
- ✅ بارگذاری تدریجی سایر تصاویر در پس‌زمینه
- ✅ کاهش قابل توجه زمان بارگذاری اولیه
- ✅ تجربه کاربری بهتر

## Technical Details

### Loading Sequence (ترتیب بارگذاری):
1. صفحه HTML و CSS لود می‌شود
2. Loading overlay نمایش داده می‌شود
3. JavaScript اجرا می‌شود
4. تصویر اولیه (random) preload می‌شود
5. تصویر به عنوان background تنظیم می‌شود
6. Loading overlay با fade-out مخفی می‌شود
7. سایر تصاویر در پس‌زمینه با فاصله 500ms preload می‌شوند
8. Thumbnails فقط هنگام باز کردن پنل تنظیمات لود می‌شوند

### Performance Metrics (معیارهای عملکرد):
- **Initial Load**: ~80% سریع‌تر (فقط یک تصویر)
- **Memory Usage**: کاهش مصرف حافظه اولیه
- **User Experience**: بازخورد فوری و بدون صفحه خالی

## توصیه‌های بیشتر / Further Recommendations

برای بهینه‌سازی بیشتر می‌توانید:
1. **فشرده‌سازی تصاویر**: استفاده از ابزارهایی مثل ImageOptim یا TinyPNG
2. **فرمت WebP**: تبدیل تصاویر به فرمت WebP (حجم کمتر با کیفیت مشابه)
3. **Responsive Images**: ارائه سایزهای مختلف برای صفحه‌نمایش‌های مختلف
4. **CDN**: استفاده از Content Delivery Network برای سرعت بالاتر
5. **Service Worker**: کش کردن تصاویر برای بازدیدهای بعدی

## آموزش تست / Testing Guide

برای تست بهینه‌سازی‌ها:
1. DevTools مرورگر را باز کنید (F12)
2. به تب Network بروید
3. گزینه Disable cache را فعال کنید
4. صفحه را Refresh کنید
5. بارگذاری تصاویر را مشاهده کنید:
   - فقط یک تصویر در ابتدا لود می‌شود
   - Loading overlay نمایش داده می‌شود
   - سایر تصاویر با تاخیر لود می‌شوند
6. پنل تنظیمات را باز کنید و بارگذاری thumbnails را مشاهده کنید

---

**تاریخ بهینه‌سازی**: 2025
**نسخه**: 1.1.0
